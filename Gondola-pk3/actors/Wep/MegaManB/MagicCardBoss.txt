actor MagicCardBoss : BaseMM8BDMWep_CBM 
{
Tag "$TAGC_BF"
dropitem "MagicCardWepCDropped"
Weapon.AmmoUse 0
Weapon.AmmoGive 600
Obituary "$OB_MAGICCARD"
Inventory.Pickupmessage "Magic... away!"
weapon.ammotype "SnortSnortAmmo"
inventory.icon "MAGII"
States
{
Spawn:
C_0B F 1
loop

Ready:
MGCH A 0 ACS_ExecuteAlways(998,0,DYE_MAGICMAN)
MGCH A 0 A_GunFlash
goto Ready1
Ready1:
MGCH A 2 A_WeaponReady(WRF_NOPRIMARY)
MGCH A 0 A_GiveInventory("SnortSnortAmmo",6)
loop

Deselect:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
TNT1 A 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
TNT1 A 1 A_Raise
Loop

Fire:
TNT1 A 1
Goto Ready1

AltFire:
MGCH A 0 A_JumpIfInventory("PowerRage_ST",1,"Altfire_R")
MGCH A 0 A_PlaySoundEx("weapon/magiccard","Weapon")
TNT1 A 0 A_GiveInventory("MagicmanMain2_CI",1)
TNT1 A 0 A_GiveInventory("MagicmanMain3_CI",1)
MGCH BBCCBBAAAA 1 A_GiveInventory("SnortSnortAmmo",2)
goto Ready1

Altfire_R:
MGCH A 0 A_PlaySoundEx("weapon/magiccard","Weapon")
TNT1 A 0 A_GiveInventory("MagicmanMain2_CI",1)
TNT1 A 0 A_GiveInventory("MagicmanMain3_CI",1)
MGCH BCBAA 1 A_GiveInventory("SnortSnortAmmo",4)
goto Ready1

Flash:
TNT1 A 1 A_JumpIfInventory("IsDead",1,"NoFlash")
TNT1 A 0 A_JumpIfInventory("MagicCardCooldown",1,"Flash")
TNT1 A 0 A_JumpIfInventory("SnortSnortAmmo",100,"Flash_MainUsable")
loop
Flash_MainUsable:
TNT1 A 1 A_JumpIfInventory("IsDead",1,"NoFlash")
TNT1 A 0 A_JumpIfInventory("MagicCardCooldown",1,"Flash")
TNT1 A 0 A_JumpIfInventory("TimeStoppedCounter",1,"Flash_MainUsable")
TNT1 A 0 A_JumpIfInventory("TimeStoppedTFFlag",1,"Flash_MainUsable")
TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("Get_Button_M") == 1, "Flash_Mainfire")
Goto Flash

Flash_Mainfire:
TNT1 A 0 A_JumpIfInventory("IsBot",1,"BotFire")
TNT1 A 0 ACS_ExecuteAlways(512,0,1)
TNT1 A 0 A_PlaySoundEx("weapon/magiccard","Weapon")
TNT1 A 0 A_GiveInventory("MagicmanMain1_CI",1)
//TNT1 A 0 A_GiveInventory("MagicmanMain3_CI",1)
TNT1 A 0 A_GiveInventory("MagicCardCooldown_RC",1)
TNT1 A 0 A_JumpIfInventory("PowerRage_ST",1,"Flash_Mainfire_R")
MGCH DEFGHIJK 1
TNT1 A 5
Goto Flash
Flash_Mainfire_R:
MGCH DFHK 1
TNT1 A 3
Goto Flash

BotFire:
TNT1 A 0 A_Jump(192,"Altfire")
TNT1 A 0 A_GiveInventory("SnortSnortAmmo",100)
goto Fire+1
}
}

actor MagicCardBosB : BaseMM8BDMWep_CBM
{
Tag "$TAGC_BF2"
dropitem "MagicCardWepCDropped"
inventory.icon "MAGII2"
Weapon.AmmoUse 0
Weapon.AmmoGive 600
Obituary "$OB_MAGICCARD"
Inventory.Pickupmessage "Magic... away!"
weapon.ammotype "SnortSnortAmmo"
States
{
Spawn:
C_0B F 1
loop

Ready:
MGCH U 0 ACS_ExecuteAlways(998,0,DYE_MAGICMAN)
goto Ready1
Ready1:
MGCH U 0 A_JumpIfInventory("SnortSnortAmmo",300,"Ready2")
MGCH U 2 A_WeaponReady(WRF_NOFIRE)
MGCH U 0 A_GiveInventory("SnortSnortAmmo",6)
loop
Ready2:
MGCH L 2 A_WeaponReady
MGCH L 0 A_GiveInventory("SnortSnortAmmo",6)
loop

Deselect:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
MGCH U 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
MGCH U 1 A_Raise
Loop

Fire:
MGCH L 0 A_JumpIfInventory("IsBot",1,"BotFire")
MGCH O 1 Offset(4,64) A_GunFlash
MGCH O 1 Offset(12,96) A_TakeInventory("FakeMagicFlag",99)
goto BallThrow

Altfire:
MGCH N 1
MGCH O 1 A_GiveInventory("FakeMagicFlag",1)
goto BallThrowFake

BallThrow:
MGCH O 1 Offset(16,108) A_GiveInventory("MagicBallThrow_P",1)
MGCH O 1 Offset(20,140)
MGCH O 1 Offset(24,178)
MGCH O 0 A_PlaySound("weapon/MagicShot",1,1.0)
MGCH O 0 A_SpawnItemEx("MagicBallEmergency",0,0,28)
MGCH O 0 A_SpawnItemEx("MagicHologram",0,0,0,0,0,0,0,1,0)
MGCH O 0 A_SpawnItemEx("MagicBall",cos(-pitch)*0,0,28+sin(-pitch),cos(-pitch)*22,0,sin(-pitch)*22,0,33,0)
MGCH O 0 A_Stop
MGCH O 0 A_ChangeFlag("NONSHOOTABLE",1)
MGCH O 0 A_GiveInventory("InvulnerableOn_Pickup",1)
MGCH O 0 A_ChangeFlag("NOTELEPORT",1)
MGCH O 0 A_ChangeFlag("SOLID",0)
MGCH O 0 A_TakeInventory("UnSolid",1)
MGCH O 1 A_ChangeFlag("PICKUP",0)
goto InvisibleLoop

BallThrowFake:
MGCH P 1 A_GiveInventory("MagicBallThrow_P",1)
MGCH PQ 1 
MGCH L 0 A_PlaySound("weapon/MagicShot",1,1.0)
MGCH L 0 A_SpawnItemEx("MagicBallEmergency",0,0,28)
MGCH L 0 A_SpawnItemEx("MagicHologram",0,0,0,0,0,0,0,1,0)
MGCH L 0 A_SpawnItemEx("MagicBall",cos(-pitch)*0,0,28+sin(-pitch),cos(-pitch)*22,0,sin(-pitch)*22,0,33,0)
MGCH L 0 A_Stop
MGCH L 0 A_ChangeFlag("NONSHOOTABLE",1)
MGCH L 0 A_GiveInventory("InvulnerableOn_Pickup",1)
MGCH L 0 A_ChangeFlag("NOTELEPORT",1)
MGCH L 0 A_ChangeFlag("SOLID",0)
MGCH L 0 A_TakeInventory("UnSolid",1)
MGCH L 1 A_ChangeFlag("PICKUP",0)
goto InvisibleLoop

InvisibleLoop:
TNT1 A 1 Offset(20,128)
TNT1 A 0 A_JumpIfInventory("MagicBallEnd",1,"InvisibleEnd")
TNT1 A 1
TNT1 A 0 A_JumpIfInventory("MagicBallEnd",1,"InvisibleEnd")
loop

InvisibleEnd:
MGCH U 0 A_JumpIf(1,1)
MGCH U 1 A_GiveInventory("MagicBallEnd",1)
MGCH U 0 A_ChangeFlag("NONSHOOTABLE",0)
MGCH U 0 A_GiveInventory("InvulnerableOff_Pickup",1)
MGCH U 0 A_ChangeFlag("PICKUP",1)
MGCH U 0 A_ChangeFlag("NOTELEPORT",0)
MGCH U 0 A_SpawnItemEx("ReSolidifier")
MGCH U 0 A_JumpIfInventory("IsBot",1,"BotFire2")
goto BallEnd2
BallEnd2:
MGB8 V 0 ThrustThingZ(0,1,0,1)
MGCH V 1 Offset(16,108)
MGCH V 1 Offset(12,96)
MGCH V 1 Offset(4,64)
MGHL U 0 A_WeaponReady(14)
MGCH UU 2 A_GiveInventory("SnortSnortAmmoResync_P",1)
MGCH U 15 A_TakeInventory("ProjectilePortDead",99)
Goto Ready+2

Flash:
MGCH A 0 A_JumpIfInventory("IsDead",1,"NoFlash")
TNT1 A 0 ACS_ExecuteAlways(512,0,1)
TNT1 A 2
MGCH RST 1
stop

BotFire:
MGCH A 0 A_Jump(128,"Altfire")
goto Fire+1
BotFire2:
MGCH A 0 A_SelectWeapon("MagicCardBoss")
goto Ready+2

}
}

actor SnortSnortAmmo : Ammo
{
inventory.amount 1
inventory.maxamount 600
+INVENTORY.IGNORESKILL
}

actor MagicCardCooldown : Powerup
{
+INVENTORY.ADDITIVETIME
Powerup.Duration 11
}

actor MagicBallEnd : OnceC{}
actor MagicBallEndFix : OnceC{}
actor MagicBallCooldown : Powerup
{
Powerup.Duration 35
}
actor FakeMagicFlag : OnceC{}

actor MagicCardCooldown_RC : CustomInventory
{
States
{
Pickup:
TNT1 A 0
TNT1 A 0 A_JumpIfInventory("PowerRage_ST",1,"PickupR")
TNT1 A 0 A_GiveInventory("MagicCardCooldown",1)
goto PickupR
PickupR:
TNT1 A 0 A_GiveInventory("MagicCardCooldown",1)
TNT1 A 0 A_TakeInventory("SnortSnortAmmo",100)
stop
}
}


actor MagicBallThrow_P : CustomInventory
{
States
{
Pickup:
TNT1 A 0 A_TakeInventory("MagicBallEndFix",99)
TNT1 A 0 A_TakeInventory("MagicBallEnd",99)
TNT1 A 0 A_TakeInventory("SnortSnortAmmo",300)
stop
}
}

actor SnortSnortAmmoResync_P : CustomInventory
{
States
{
Pickup:
TNT1 A 0 A_GiveInventory("SnortSnortAmmo",1)
TNT1 A 0 A_TakeInventory("SnortSnortAmmo",1)
stop
}
}

actor MagicCardB
{
translation "192:192=216:216","198:198=3:3"
PROJECTILE
Damagetype "MagicCard" 
Obituary "$OB_MAGICCARD"
+NOCLIP
+NOINTERACTION
+THRUGHOST
+NOTARGETSWITCH
+DONTREFLECT
+SEEKERMISSILE
ReactionTime 70
damage (0)
Radius 5
Height 5
speed 50
scale 2.5
States
{
Spawn:
MCAR M 0
MCAR M 0 A_RearrangePointers(0,0,2)
MCAR MM 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,momx,momy,momz,0,8)
MCAR NNOOOOOO 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,momx,momy,momz,0,8)
MCAR P 0 A_ScaleVelocity(0.5)
MCAR PP 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,momx,momy,momz,0,8)
MCAR P 0 A_ScaleVelocity(0.5)
MCAR QQ 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,momx,momy,momz,0,8)
MCAR Q 0 A_ScaleVelocity(-2.0)
MCAR RR 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,momx,momy,momz,0,8)
//MCAR R 0 A_SpawnItemEx("ReturningMagicCardB",0,0,0,0,0,0,0,1)
goto Spawn2
/*
MCAR A 0
MCAR AA 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,2,0,0)
MCAR BBCCCCCC 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,2,0,0)
MCAR D 0 A_ScaleVelocity(0.5)
MCAR DD 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,2,0,0)
MCAR D 0 A_ScaleVelocity(0.5)
MCAR EE 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,2,0,0)
MCAR D 0 A_ScaleVelocity(-2.0)
MCAR FF 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,2,0,0)
MCAR A 0 A_CustomMissile("ReturningMagicCardB",0,0,0,0)
stop
*/


Spawn2:
MCAR N 0
MCAR N 0 A_FaceTarget
goto Spawn3
Spawn3:
MCAR N 0
MCAR N 0 A_JumpIfCloser(64,"Death")
MCAR NN 0 A_SeekerMissile(90,90,2)
MCAR NN 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,momx,momy,momz,0,8)
MCAR N 0 A_JumpIfCloser(64,"Death")
MCAR OO 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,momx,momy,momz,0,8)
MCAR O 0 A_JumpIfCloser(64,"Death")
MCAR PP 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,momx,momy,momz,0,8)
MCAR P 0 A_JumpIfCloser(64,"Death")
MCAR QQ 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,momx,momy,momz,0,8)
MCAR Q 0 A_JumpIfCloser(64,"Death")
MCAR RR 1 A_SpawnItemEx("MagicCardDamagerB",0,0,0,momx,momy,momz,0,8)
MCAR R 0 A_JumpIfCloser(64,"Death")

MCAR N 0 A_CountDown
MCAR N 0 A_JumpIf(ACS_ExecuteWithResult(C_CHECK_TARGET_OOC)==0,"Death")
loop
Death:
MCAR M 0
Stop
}
}

actor MagicCardBB : MagicCardB{translation "192:192=205:205","198:198=74:74"}
actor MagicCardBR : MagicCardB{translation "192:192=171:171","198:198=41:41"}
actor MagicCardBO : MagicCardB{translation "192:192=104:104","198:198=128:128"}
actor MagicCardBP : MagicCardB{translation "192:192=229:229","198:198=232:232"}

actor MagicCard2B : MagicCardB
{
States
{
Spawn:
MCAR M 0
MCAR M 0 A_RearrangePointers(0,0,2)
MCAR MM 1 A_SpawnItemEx("MagicCardDamager2B",0,0,0,momx,momy,momz,0,8)
MCAR NNOOOOOO 1 A_SpawnItemEx("MagicCardDamager2B",0,0,0,momx,momy,momz,0,8)
MCAR P 0 A_ScaleVelocity(0.5)
MCAR PP 1 A_SpawnItemEx("MagicCardDamager2B",0,0,0,momx,momy,momz,0,8)
MCAR P 0 A_ScaleVelocity(0.5)
MCAR QQ 1 A_SpawnItemEx("MagicCardDamager2B",0,0,0,momx,momy,momz,0,8)
MCAR Q 0 A_ScaleVelocity(-2.0)
MCAR RR 1 A_SpawnItemEx("MagicCardDamager2B",0,0,0,momx,momy,momz,0,8)
goto Spawn2
Spawn2:
MCAR N 0
MCAR N 0 A_FaceTarget
goto Spawn3
Spawn3:
MCAR N 0
MCAR N 0 A_JumpIfCloser(64,"Death")
MCAR NN 0 A_SeekerMissile(90,90,2)
MCAR NN 1 A_SpawnItemEx("MagicCardDamager2B",0,0,0,momx,momy,momz,0,8)
MCAR N 0 A_JumpIfCloser(64,"Death")
MCAR OO 1 A_SpawnItemEx("MagicCardDamager2B",0,0,0,momx,momy,momz,0,8)
MCAR O 0 A_JumpIfCloser(64,"Death")
MCAR PP 1 A_SpawnItemEx("MagicCardDamager2B",0,0,0,momx,momy,momz,0,8)
MCAR P 0 A_JumpIfCloser(64,"Death")
MCAR QQ 1 A_SpawnItemEx("MagicCardDamager2B",0,0,0,momx,momy,momz,0,8)
MCAR Q 0 A_JumpIfCloser(64,"Death")
MCAR RR 1 A_SpawnItemEx("MagicCardDamager2B",0,0,0,momx,momy,momz,0,8)
MCAR R 0 A_JumpIfCloser(64,"Death")

MCAR N 0 A_CountDown
MCAR N 0 A_JumpIf(ACS_ExecuteWithResult(C_CHECK_TARGET_OOC)==0,"Death")
loop
}
}

actor MagicCard2BB : MagicCard2B{translation "192:192=205:205","198:198=74:74"}
actor MagicCard2BR : MagicCard2B{translation "192:192=171:171","198:198=41:41"}
actor MagicCard2BO : MagicCard2B{translation "192:192=104:104","198:198=128:128"}
actor MagicCard2BP : MagicCard2B{translation "192:192=229:229","198:198=232:232"}

actor MagicCardBF : MagicCardB
{
translation "192:192=216:216","198:198=3:3"
States
{
Spawn:
MCAR M 0
MCAR M 0 A_RearrangePointers(0,0,2)
MCAR MM 1 A_SpawnItemEx("MagicCardDamagerBF",0,0,0,momx,momy,momz,0,8)
MCAR NNOOOOOO 1 A_SpawnItemEx("MagicCardDamagerBF",0,0,0,momx,momy,momz,0,8)
MCAR P 0 A_ScaleVelocity(0.5)
MCAR PP 1 A_SpawnItemEx("MagicCardDamagerBF",0,0,0,momx,momy,momz,0,8)
MCAR P 0 A_ScaleVelocity(0.5)
MCAR QQ 1 A_SpawnItemEx("MagicCardDamagerBF",0,0,0,momx,momy,momz,0,8)
MCAR Q 0 A_ScaleVelocity(-2.0)
MCAR RR 1 A_SpawnItemEx("MagicCardDamagerBF",0,0,0,momx,momy,momz,0,8)
goto Spawn2
Spawn2:
MCAR N 0 A_FaceTarget
goto Spawn3
Spawn3:
MCAR N 0
MCAR N 0 A_JumpIfCloser(64,"Death")
MCAR NN 0 A_SeekerMissile(90,90,2)
MCAR NN 1 A_SpawnItemEx("MagicCardDamagerBF",0,0,0,momx,momy,momz,0,8)
MCAR N 0 A_JumpIfCloser(64,"Death")
MCAR OO 1 A_SpawnItemEx("MagicCardDamagerBF",0,0,0,momx,momy,momz,0,8)
MCAR O 0 A_JumpIfCloser(64,"Death")
MCAR PP 1 A_SpawnItemEx("MagicCardDamagerBF",0,0,0,momx,momy,momz,0,8)
MCAR P 0 A_JumpIfCloser(64,"Death")
MCAR QQ 1 A_SpawnItemEx("MagicCardDamagerBF",0,0,0,momx,momy,momz,0,8)
MCAR Q 0 A_JumpIfCloser(64,"Death")
MCAR RR 1 A_SpawnItemEx("MagicCardDamagerBF",0,0,0,momx,momy,momz,0,8)
MCAR R 0 A_JumpIfCloser(64,"Death")

MCAR N 0 A_CountDown
MCAR N 0 A_JumpIf(ACS_ExecuteWithResult(C_CHECK_TARGET_OOC)==0,"Death")
loop
Death:
MCAR M 0
Stop
}
}


actor MagicCardBFB : MagicCardBF{translation "192:192=205:205","198:198=74:74"}
actor MagicCardBFR : MagicCardBF{translation "192:192=171:171","198:198=41:41"}
actor MagicCardBFO : MagicCardBF{translation "192:192=104:104","198:198=128:128"}
actor MagicCardBFP : MagicCardBF{translation "192:192=229:229","198:198=232:232"}

actor MagicCardDamagerB : MagicCardDamager
{
Damagetype "MagicCardB" 
Damage (6)
States
{
Spawn:
TNT1 A 1
stop
}
}

actor MagicCardDamager2B : MagicCardDamager
{
Damagetype "MagicCard2B" 
Damage (6)
States
{
Spawn:
TNT1 A 1
stop
}
}


actor MagicCardProtectC : PowerProtection
{
Powerup.Duration 5
DamageFactor "MagicCardB", 0.0
}

actor MagicCardProtect2C : PowerProtection
{
Powerup.Duration 5
DamageFactor "MagicCard2B", 0.0
}

actor MagicCardDamagerBF : MagicCardDamagerB
{
Damagetype "MagicCardBF"
Obituary "$OB_FAKEMAGICCARD"
Damage (1)
+PIERCEARMOR
}

actor MagicBall
{
translation "199:199=176:176","202:202=218:218"
PROJECTILE
Damagetype "MagicCard"
Obituary "$OB_MAGICBALL"
+DONTBLAST
+DONTREFLECT
+THRUGHOST
+SKYEXPLODE
-NOGRAVITY
Gravity 0.50
ReactionTime 60
Damage (0)
Radius 16
Height 56
Speed 20
scale 2.5
states
{
Spawn:
MGB8 M 0
MGB8 M 0 ACS_ExecuteAlways(815,0,200)//200
MGB8 M 0 ThrustThingZ(0,20,0,1)
MGB8 M 0 A_GiveToTarget("MagicBallPickupSync",1)
MGB8 M 1 A_JumpIfInTargetInventory("MagicBallEnd",1,"Death")
MGB8 M 0 A_GiveToTarget("MagicBallPickupSync",1)
MGB8 M 1 A_JumpIfInTargetInventory("MagicBallEnd",1,"Death")
goto Spawn2+2
Spawn2:
MGB8 M 0 A_GiveToTarget("MagicBallCooldown",1)
MGB8 MMNNOOPP 1 A_JumpIfInTargetInventory("MagicBallEnd",1,"Death")
MGB8 M 0 A_CountDown
loop
Death:
TNT1 A 0 A_GiveInventory("ProjectilePortDead",1)
TNT1 A 0 A_ChangeFlag("NOINTERACTION",1)
TNT1 A 0 A_Stop
TNT1 A 0 A_ChangeFlag("NOGRAVITY",1)
TNT1 A 0 A_GiveToTarget("MagicBallEnd",1)
TNT1 A 0 //A_GiveToTarget("MagicBallPickupSync2",1)
TNT1 A 0 //A_PlaySound("weapon/napalm",1,1.0)
TNT1 A 0 A_SpawnItemEx("MagicFirework",0,0,9,0,0,12)
TNT1 A 0 A_SpawnItemEx("MagicBallFX",0,0,0,0,0,0,0,1)
TNT1 A 0 A_JumpIfInTargetInventory("FakeMagicFlag",1,"Death2")
TNT1 A 0 A_SpawnItemEx("MagicBallExplosion",0,0,16)
TNT1 AA 1 A_GiveToTarget("MagicBallPickupSync2",1)
stop
Death2:
TNT1 A 2 A_SpawnItemEx("MagicBallExplosion2",0,0,16)
TNT1 AA 1 A_GiveToTarget("MagicBallPickupSync2",1)
stop
}
}

actor MagicBallEmergency : MagicBall
{
+NOINTERACTION
+NOGRAVITY
ReactionTime 240
Radius 2
Height 2
States
{
Spawn:
TNT1 A 0
TNT1 A 0 A_GiveToTarget("MagicBallPickupSync",1)
Spawn2:
TNT1 AA 1 A_JumpIfInTargetInventory("MagicBallEnd",1,"Death3")
TNT1 A 0 A_CountDown
TNT1 A 0 A_JumpIfInTargetInventory("MagicBallCooldown",1,"Spawn2")
goto Death3
Death:
TNT1 A 0 A_GiveToTarget("MagicBallEndFix",1)
goto Death3
Death3:
TNT1 A 0 A_GiveToTarget("MagicBallEnd",1)
TNT1 AA 1 A_GiveToTarget("MagicBallPickupSync2",1)
stop
}
}

actor MagicBallExplosion : BasicExplosion
{
Damagetype "MagicCard"//ClassPain
Obituary "$OB_MAGICBALL"
States
{
Spawn:
TNT1 A 0
TNT1 A 0 A_JumpIfInTargetInventory("PowerSpread_ST",1,"Spawn_S")
TNT1 A 2 A_Explode(18,64,0,0,18)
stop
Spawn_S:
TNT1 AAA 0 A_Explode(18,64,0,0,18)
TNT1 A 2
stop
}
}

actor MagicBallExplosion2 : MagicBallExplosion
{
Obituary "$OB_FAKEMAGICBALL"
}

actor MagicBallPickupSync : CustomInventory
{
States
{
Pickup:
TNT1 A 0 A_GiveInventory("MagicBallCooldown",1)
TNT1 A 0 A_SetTranslucent(0.0,0)
stop
}
}

actor MagicBallPickupSync2 : CustomInventory
{
States
{
Pickup:
TNT1 A 0 A_SetTranslucent(1.0,0)
stop
}
}

actor MagicBallB : MagicBall{translation "199:199=74:74","202:202=205:205"}
actor MagicBallR : MagicBall{translation "199:199=41:41","202:202=171:171"}
actor MagicBallO : MagicBall{translation "199:199=128:128", "202:202=104:104"}
actor MagicBallP : MagicBall{translation "199:199=232:232", "202:202=229:229"}

actor MagicFirework
{
-SOLID
+NOGRAVITY
+NOINTERACTION
scale 2.5
States
{
Spawn:
DOMP G 2
DOMP G 0 A_Stop
DOMP H 4 A_SpawnItemEx("MagicFireworkExp",random(-15,15),random(-15,15),10)
DOMP H 4 A_SpawnItemEx("MagicFireworkExp",random(-15,15),random(-15,15),0)
DOMP H 4 A_SpawnItemEx("MagicFireworkExp",random(-15,15),random(-15,15),-10)
stop
}
}

actor MagicFireworkExp
{
-SOLID
scale 2.0
+NOGRAVITY
+NOINTERACTION
States
{
Spawn:
DOMP IJKLMN 4
stop
}
}

actor MagicBallFX
{
-SOLID
+NOGRAVITY
+NOINTERACTION
Scale 2.5
radius 0
height 0
States
{
Spawn:
MGB8 Q 2
TNT1 A 2
MGB8 R 2
TNT1 A 2
MGB8 S 2
TNT1 A 2
MGB8 T 2
stop
}
}

actor MagicBirdsSound : BasicHelper
{
States
{
Spawn:
TNT1 A 0
TNT1 A 0 A_PlaySound("weapon/MagicBirds",1,1.0)
stop
}
}

actor MagicHomingBirds
{
Translation "195:195=4:4", "204:204=212:212"
PROJECTILE
+DONTSEEKINVISIBLE//
+SEEKERMISSILE
Radius 6
Height 5
scale 2.0
damagetype "ClassPainLess"
Obituary "$OB_MAGICBIRD"
damage (3)
speed 19
reactiontime 10
States
{
Spawn:
TNT1 A 0
TNT1 A 0 ACS_NamedExecuteAlways("BULL_Tidifier", 0)
SpawnLOOP:
TNT1 A 1
TNT1 A 0 A_Jump(256,1,2,3,4,5,6,7,8,9,10,11,12)
Spawn2:
MGB8 AAABBBCCCDDD 1 A_SeekerMissile(1,4,3,64,3)
MGB8 A 0 A_CountDown
loop
Death:
VMFX QRS 2
SMFX D 2
stop
}
}

actor ConfettiMagic : Confetti
{
+THRUGHOST
}

actor ConfettiMagicSpawner : ConfettiSpawner
{
ReactionTime 10//10
States
{
Spawn:
TNT1 A 0
TNT1 A 1 A_PlaySoundEx("misc/partyball", 1)
goto Spawn2
Spawn2:
TNT1 AAA 0 A_SpawnItemEx("ConfettiMagic",random(-16, 16),random(-16, 16),Random(8, 16),random(-3,3), random(-3,3), random(1,-1),0)
TNT1 A 1 A_CountDown
Loop
}
}

actor ConfettiPickup : CustomInventory
{
states
{
Pickup:
TNT1 A 0 A_SpawnItemEx("ConfettiMagicSpawner",0,0,28)
stop
}
}

actor MagicHologram
{
var int user_TID;
-SOLID
+NOGRAVITY
+DONTBLAST
+DONTREFLECT
+THRUACTORS
//+NOINTERACTION
height 56
radius 16
scale 2.5
renderstyle translucent
alpha 0.5
States
{
Spawn:
MGIC G 0
Spawn2:
MGIC G 0 A_JumpIf(ACS_ExecuteWithResult(C_CHECK_TARGET_OOC)==0,"Death")
MGIC G 0 A_JumpIfInTargetInventory("MagicBallEnd",1,"End")
MGIC G 1
loop
End:
TNT1 A 0 A_JumpIfInTargetInventory("MagicBallEndFix",1,2)
TNT1 A 0 A_JumpIfInTargetInventory("FakeMagicFlag",1,"TeleportBack")
TNT1 A 0 A_GiveInventory("ConfettiPickup",1)
TNT1 A 0 A_GiveToTarget("ConfettiPickup",1)
TNT1 A 0 A_GiveToTarget("MagicTeleportScaleV",1)
EndBirds:
TNT1 A 0 A_ChangeFlag("MISSILE",1)
TNT1 A 0 //ACS_ExecuteAlways(790,0)
TNT1 A 0 A_GiveInventory("MagicBirdAttack",1)
goto Death
TeleportBack:
TNT1 A 0 A_GiveToTarget("MagicBirdAttack2",1)
TNT1 A 0 A_GiveToTarget("MagicTeleportScaleV",1)
//TNT1 A 1
//TNT1 A 0 Thing_Move(ACS_ExecuteWithResult(257,0),0,1)
TNT1 A 0 A_SetUserVar("user_TID",ACS_ExecuteWithResult(257,0))
TNT1 A 0 Thing_ChangeTID(0,user_TID+600)
TNT1 A 0 Thing_Move(user_TID,TID,1)
TNT1 A 0 A_GiveToTarget("Nudge",1)
//TNT1 A 0 Thing_ChangeTID(0,0)
goto Death
Death:
TNT1 A 1
stop
}
}

actor MagicHologramBirds : MagicHologram
{
States
{
Spawn:
TNT1 A 0 
goto EndBirds
}
}

actor MagicBirdAttack2 : CustomInventory
{
states
{
Pickup:
TNT1 A 0 A_SpawnItemEx("MagicHologramBirds",0,0,0,0,0,0,0,1,0)
stop
}
}

actor MagicTeleportScaleV : CustomInventory
{
States
{
Pickup:
TNT1 A 0 A_ScaleVelocity(0.1)
stop
}
}

actor MagicBirdAttack : CustomInventory
{
states
{
Pickup:
TNT1 A 0 A_SpawnItemEx("MagicBirdsSound",0,0,16)
TNT1 A 0
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,0,70,16,0,0.65,0,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,28,42,16,0,0.35,-4,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,-28,42,16,0,0.35,4,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,0,28,16,0,0,0,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,28,14,16,0,-0.35,-4,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,-28,14,16,0,-0.35,4,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,0,-14,16,0,-0.65,0,1)
TNT1 A 0 A_JumpIfInTargetInventory("PowerSpread_ST",1,"Pickup_S")
//SpawnItemEx Simulation of the below
//TNT1 A 0 A_CustomMissile("MagicHomingBirds",70,0,0,2,2)
//TNT1 A 0 A_CustomMissile("MagicHomingBirds",42,28,-4,2,1)
//TNT1 A 0 A_CustomMissile("MagicHomingBirds",42,-28,4,2,1)
//TNT1 A 0 A_CustomMissile("MagicHomingBirds",28,0,0,2,0)
//TNT1 A 0 A_CustomMissile("MagicHomingBirds",14,28,-4,2,-1)
//TNT1 A 0 A_CustomMissile("MagicHomingBirds",14,-28,4,2,-1)
//TNT1 A 0 A_CustomMissile("MagicHomingBirds",-14,0,0,2,-2)
stop
Pickup_S:
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,0,70,16,0,0.65,15,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,28,42,16,0,0.35,11,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,-28,42,16,0,0.35,19,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,0,28,16,0,0,15,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,28,14,16,0,-0.35,11,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,-28,14,16,0,-0.35,19,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,0,-14,16,0,-0.65,15,1)

TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,0,70,16,0,0.65,-15,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,28,42,16,0,0.35,-19,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,-28,42,16,0,0.35,-11,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,0,28,16,0,0,-15,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,28,14,16,0,-0.35,-19,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,-28,14,16,0,-0.35,-11,1)
TNT1 A 0 A_SpawnItemEx("MagicHomingBirds",4,0,-14,16,0,-0.65,-15,1)
stop
}
}

actor MagicmanMain1_CI : TeamColor_CI
{
states
{
FireX:
TNT1 A 0 A_FireCustomMissile("MagicCardB",0,1,0,15)
TNT1 A 0 A_FireCustomMissile("MagicCard2B",0,1,0,-15)
goto Done
FireB:
TNT1 A 0 A_FireCustomMissile("MagicCardBB",0,1,0,15)
TNT1 A 0 A_FireCustomMissile("MagicCard2BB",0,1,0,-15)
goto Done
FireR:
TNT1 A 0 A_FireCustomMissile("MagicCardBR",0,1,0,15)
TNT1 A 0 A_FireCustomMissile("MagicCard2BR",0,1,0,-15)
goto Done
FireO:
TNT1 A 0 A_FireCustomMissile("MagicCardBO",0,1,0,15)
TNT1 A 0 A_FireCustomMissile("MagicCard2BO",0,1,0,-15)
goto Done
FireP:
TNT1 A 0 A_FireCustomMissile("MagicCardBP	",0,1,0,15)
TNT1 A 0 A_FireCustomMissile("MagicCard2BP",0,1,0,-15)
goto Done
}
}

actor MagicmanMain2_CI : TeamColor_CI
{
states
{
FireX:
TNT1 A 0 A_FireCustomMissile("MagicCardBF",0,0,0,0)
goto Done
FireB:
TNT1 A 0 A_FireCustomMissile("MagicCardBFB",0,0,0,0)
goto Done
FireR:
TNT1 A 0 A_FireCustomMissile("MagicCardBFR",0,0,0,0)
goto Done
FireO:
TNT1 A 0 A_FireCustomMissile("MagicCardBFO",0,0,0,0)
goto Done
FireP:
TNT1 A 0 A_FireCustomMissile("MagicCardBFP",0,0,0,0)
goto Done
}
}


actor MagicmanMain3_CI : TeamColor_CI
{
states
{
FireX:
TNT1 A 0 A_FireCustomMissile("MagicCardBF",(random(0,1)*2-1)*random(1,10),0,0,0,0,(random(0,1)*2-1)*random(1,10))
goto Done
FireB:
TNT1 A 0 A_FireCustomMissile("MagicCardBFB",(random(0,1)*2-1)*random(1,10),0,0,0,0,(random(0,1)*2-1)*random(1,10))
goto Done
FireR:
TNT1 A 0 A_FireCustomMissile("MagicCardBFR",(random(0,1)*2-1)*random(1,10),0,0,0,0,(random(0,1)*2-1)*random(1,10))
goto Done
FireO:
TNT1 A 0 A_FireCustomMissile("MagicCardBFO",(random(0,1)*2-1)*random(1,10),0,0,0,0,(random(0,1)*2-1)*random(1,10))
goto Done
FireP:
TNT1 A 0 A_FireCustomMissile("MagicCardBFP",(random(0,1)*2-1)*random(1,10),0,0,0,0,(random(0,1)*2-1)*random(1,10))
goto Done
}
}
