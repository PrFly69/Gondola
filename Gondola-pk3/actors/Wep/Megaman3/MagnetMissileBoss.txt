actor MagnetMissileBoss : BaseMM8BDMWep_CBM
{
tag "$TAGC_3B"
dropitem "MagnetMissileWepCDropped"
Weapon.AmmoUse 0
Weapon.AmmoGive 0
Obituary "$OB_MAGNETMISSILE"
Inventory.Pickupmessage "Power up! YOU GOT SOME POWER!!!"
weapon.ammotype "PullCharge"
+WEAPON.Alt_AMMO_OPTIONAL
+WEAPON.NOAUTOAIM
States
{
Spawn:
C_03 B 1
loop
Ready:
MAGB A 0 ACS_ExecuteAlways(998,0,DYE_MAGNETMAN)
MAGB A 0 A_GunFlash
goto Ready1
Delay:
MAGB A 10 A_WeaponReady(WRF_ALLOWRELOAD)
goto Ready1
Ready1:
MAGB A 0 A_JumpIfInventory("PullCharge",14,"Ready2")
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 0 A_GiveInventory("PullCharge",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 0 A_GiveInventory("PullCharge",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 0 A_GiveInventory("PullCharge",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 //A_SpawnItemEx("PullChargeFX_Helper",0,0,0,0,0,0,0,1)
MAGB A 0 A_GiveInventory("PullCharge",1)
loop
Ready2:
MAGB A 0 A_JumpIfInventory("PullCharge",28,"Ready3")
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 0 A_GiveInventory("PullCharge",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 0 //A_SpawnItemEx("PullChargeFX_Helper",0,0,0,0,0,0,0,1)
MAGB A 0 A_GiveInventory("PullCharge",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 0 A_GiveInventory("PullCharge",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 //A_SpawnItemEx("PullChargeFX_Helper",0,0,0,0,0,0,0,1)
MAGB A 0 A_GiveInventory("PullCharge",1)
loop
Ready3:
MAGB A 0 A_JumpIfInventory("PullCharge",42,"Ready4")
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 0 A_GiveInventory("PullCharge",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB AA 0 //A_SpawnItemEx("PullChargeFX_Helper",0,0,0,0,0,0,0,1)
MAGB A 0 A_GiveInventory("PullCharge",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 0 A_GiveInventory("PullCharge",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB AA 0 //A_SpawnItemEx("PullChargeFX_Helper",0,0,0,0,0,0,0,1)
MAGB A 0 A_GiveInventory("PullCharge",1)
loop
Ready4:
MAGB A 0 A_JumpIfInventory("PullCharge",56,"Ready5")
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 0 //A_SpawnItemEx("PullChargeFX_Helper",0,0,0,0,0,0,0,1)
MAGB A 0 A_GiveInventory("PullCharge",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 0 //A_SpawnItemEx("PullChargeFX_Helper",0,0,0,0,0,0,0,1)
MAGB A 0 A_GiveInventory("PullCharge",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 0 //A_SpawnItemEx("PullChargeFX_Helper",0,0,0,0,0,0,0,1)
MAGB A 0 A_GiveInventory("PullCharge",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 //A_SpawnItemEx("PullChargeFX_Helper",0,0,0,0,0,0,0,1)
MAGB A 0 A_GiveInventory("PullCharge",1)
loop
Ready5:
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB AA 0 //A_SpawnItemEx("PullChargeFX_Helper",0,0,0,0,0,0,0,1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB AA 0 //A_SpawnItemEx("PullChargeFX_Helper",0,0,0,0,0,0,0,1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB AA 0 //A_SpawnItemEx("PullChargeFX_Helper",0,0,0,0,0,0,0,1)
MAGB A 4 A_WeaponReady(WRF_ALLOWRELOAD)
MAGB AA 0 //A_SpawnItemEx("PullChargeFX_Helper",0,0,0,0,0,0,0,1)
MAGB A 0 A_GiveInventory("PullCharge",4)
loop

Deselect:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
MAGB A 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
MAGB A 1 A_Raise
Loop

Fire:
MAGB A 0 A_JumpIfInventory("IsBot",1,"BotFire")
MAGB A 0 A_JumpIfInventory("MagnetFlag",5,"Continued")
goto NoAmmo
Continued:
MAGB A 0 A_TakeInventory("MagnetmanFlag1",9)
MAGB A 2 A_TakeInventory("MagnetmanFlag2",9)
MAGB A 0 A_PlaySoundEx("weapon/magnetmissile","Weapon")
MAGB A 1 OffSet(-14,22)A_GiveInventory("MagnetmanMain_CI",1)
MAGB A 0 A_TakeInventory("MagnetFlag",5)
goto FireH
FireH:
MAGB A 0 A_JumpIfInventory("MagnetmanFlag2",1,"FireEndX")
MAGB A 1 OffSet(-28,12)
MAGB A 0 A_Refire("FireH1")
goto FireEnd
FireH1:
MAGB A 0 A_JumpIfInventory("MagnetmanFlag2",1,"FireEndX")
MAGB A 1 OffSet(-28,12)A_JumpIfInventory("PowerRage_ST",1,"FireH2")
MAGB A 0 A_Refire("FireH2")
goto FireEnd
FireH2:
MAGB A 0 A_JumpIfInventory("MagnetmanFlag2",1,"FireEndX")
MAGB A 1 OffSet(-28,12)
MAGB A 0 A_Refire("FireH3")
goto FireEnd
FireH3:
MAGB A 0 A_JumpIfInventory("MagnetmanFlag2",1,"FireEndX")
MAGB A 1 OffSet(-28,12)A_JumpIfInventory("PowerRage_ST",1,"FireH4")
MAGB A 0 A_Refire("FireH4")
goto FireEnd
FireH4:
MAGB A 0 A_JumpIfInventory("MagnetmanFlag2",1,"FireEndX")
MAGB A 1 OffSet(-28,12)
MAGB A 0 A_Refire("FireH5")
goto FireEnd
FireH5:
MAGB A 0 A_JumpIfInventory("MagnetmanFlag2",1,"FireEndX")
MAGB A 1 OffSet(-28,12)A_JumpIfInventory("PowerRage_ST",1,"FireH6")
MAGB A 0 A_Refire("FireH6")
goto FireEnd
FireH6:
MAGB A 0 A_JumpIfInventory("MagnetmanFlag2",1,"FireEndX")
MAGB A 1 OffSet(-28,12)
MAGB A 0 A_Refire("FireH7")
goto FireEnd
FireH7:
MAGB A 0 A_JumpIfInventory("MagnetmanFlag2",1,"FireEndX")
MAGB A 1 OffSet(-28,12)A_JumpIfInventory("PowerRage_ST",1,"FireH8")
MAGB A 0 A_Refire("FireH8")
goto FireEnd
FireH8:
MAGB A 0 A_JumpIfInventory("MagnetmanFlag2",1,"FireEndX")
MAGB A 1 OffSet(-28,12)
MAGB A 0 A_Refire("FireH")
goto FireEnd
FireEndX:
MAGB A 0 A_ClearRefire
FireEnd:
MAGB B 3 OffSet(-20,16)A_GiveInventory("MagnetmanFlag1",1)
MAGB B 3 OffSet(-12,20)A_WeaponReady(7)
MAGB A 3 OffSet(-6,24)A_WeaponReady(7)
MAGB A 3 OffSet(-2,28)A_WeaponReady(7)
Goto Delay

NoAmmo:
MAGB A 10
MAGB A 0 A_GiveInventory("MagnetFlag",1)
MAGB A 0 A_GiveInventory("PullCharge",1)
goto Ready1

Altfire:
MAGB A 0 A_JumpIfInventory("CutterFlag",1,"AltDetonate")
MAGB A 0 A_JumpIfInventory("MagFlyDelay",1,"NoAmmo")
MAGB A 0 A_JumpIfInventory("MagFlyIsOut",1,"NoAmmo")
MAGB A 0 A_GiveInventory("CutterFlag",1)
MAGB H 0 A_PlaySoundEx("weapon/woolshot","Weapon")
MAGB HI 1
TNT1 A 0 A_GiveInventory("MagnetmanAlt_CI",1)
MAGB JKLM 1
TNT1 A 6
MAGB A 1 Offset(0,56)
MAGB A 1 Offset(0,48)
MAGB A 1 Offset(0,40)
MAGB A 1 
MAGB A 5 
Goto Ready1

AltDetonate:
MAGB A 0 A_TakeInventory("CutterFlag",1)
MAGB H 0 A_PlaySoundEx("misc/astroplatformdisappear","Body")
MAGB A 1 OffSet(-14,22)
TNT1 A 0 A_GiveInventory("WeaponCharge",1)
MAGB A 1 OffSet(-28,12)
MAGB B 3 OffSet(-20,16)
MAGB B 3 OffSet(-12,20)
MAGB A 3 OffSet(-6,24)
MAGB A 3 OffSet(-2,28)
TNT1 A 0 A_TakeInventory("WeaponCharge",999)
Goto Ready1

Reload:
MAGB A 0 A_JumpIfInventory("PullCharge",14,1)
goto NoAmmo
MAGB H 0 A_PlaySoundEx("weapon/magnetmine","Body")
MAGB HI 1
MAGB H 0 A_PlaySoundEx("weapon/coilfire1","Weapon")
MAGB A 0 A_TakeInventory("PullCharge",14)
TNT1 A 0 A_GiveInventory("MagnetReload_CI",1)
MAGB JKLM 1
TNT1 A 6
MAGB A 1 Offset(0,56)
MAGB A 1 Offset(0,48)
MAGB A 1 Offset(0,40)
MAGB A 10
Goto Ready1

BotFire:
MAGB A 0 A_JumpIfCloser(200,"AltCheck")
MAGB A 0 A_GiveInventory("BotRetreatFlag",1)
MAGB A 4 OffSet(-9,27)
MAGB A 0 A_PlaySoundEx("weapon/magnetmissile","Weapon")
MAGB A 0 A_GiveInventory("MagnetmanMainX_CI",1)
MAGB A 4 OffSet(-18,14)
MAGB A 4 OffSet(-9,27)
MAGB A 12 A_WeaponReady(14)
MAGB A 0 A_TakeInventory("BotRetreatFlag",999)
Goto Ready1
Run:
MAGB A 0 A_GiveInventory("BotRetreatFlag",1)
MAGB A 1
MAGB A 0 A_TakeInventory("BotRetreatFlag",999)
Goto Ready1
AltCheck:
MAGB A 0 A_JumpIfInventory("PullCharge",28,"AltEndPull")
MAGB A 0 A_Jump(32,"AltEndPull")
MAGB A 0 ACS_ExecuteAlways(CORE_ACS_191,0,APROP_Speed,1,4)
MAGB A 0 //SetPlayerProperty(0,1,0)
MAGB A 0 A_PlaySoundEx("weapon/magPush","auto")
MAGB C 3 Offset(1,33)A_GiveInventory("PullCharge",random(2,4))
MAGB C 3 Offset(1,58)A_GiveInventory("PullCharge",random(2,4))
goto AltCheck

Flash:
TNT1 A 1 A_TakeInventory("MagFlyDelay",1)
loop
}
}

/*actor MagnetReloadItem : CustomInventory
{
inventory.amount 1
inventory.maxamount 1
inventory.icon "MAGNETSI"
scale 2.0
inventory.pickupmessage "Hey, hey, step aside, Crash Man. It's time for Magnet Man to finish this job with his Magnet Missiles."
+INVBAR
states
{
Spawn:
MAGB X 1
loop
Use:
TNT1 A 0 A_JumpIfInventory("MReload",1,"No")
TNT1 A 0 A_JumpIfInventory("MagnetFlag",5,"No")
TNT1 A 0 A_PlaySoundEx("weapon/BoobeamBeep","SoundSlot6")
TNT1 A 0 A_GiveInventory("MReload",1)
fail
No:
TNT1 A 0
fail
}
}

actor MReload : Inventory
{
inventory.amount 1
inventory.maxamount 1
}*/

actor PullCharge : Ammo
{
inventory.amount 1
inventory.maxamount 56
+INVENTORY.IGNORESKILL
}

actor MagnetFlag : Ammo
{
inventory.amount 1
inventory.maxamount 40
+INVENTORY.IGNORESKILL
}

actor MagFlyDelay : Ammo
{
inventory.amount 1
inventory.maxamount 105
+INVENTORY.IGNORESKILL
}

actor MagFlyIsOut : OnceC{}

actor MagnetmanFlag1 : OnceC{}
actor MagnetmanFlag2 : OnceC{}

actor MagMissileClassX
{
Translation "192:192=4:4", "198:198=41:41"
PROJECTILE
damagetype "MagnetMissile"
Obituary "$OB_MAGNETMISSILE"
+DONTSEEKINVISIBLE//
+SEEKERMISSILE
+SCREENSEEKER
ReactionTime 85
damage (15)
Radius 8
Height 5
speed 44
scale 2.5

States
{
Spawn:
TNT1 A 0
TNT1 A 0 ACS_NamedExecuteAlways("BULL_Tidifier", 0)
SpawnLOOP:
MAGB T 2 A_SeekerMissile(2,10,3,88,10)
MAGB T 0 A_CountDown
loop
Death:
TMFX ABCD 2
stop
}
}

actor MagMissileClassXB : MagMissileClassX{translation "192:192=205:205", "198:198=74:74"}
actor MagMissileClassXR : MagMissileClassX{translation "192:192=171:171", "198:198=41:41"}
actor MagMissileClassXO : MagMissileClassX{translation "192:192=104:104", "198:198=128:128"}
actor MagMissileClassXP : MagMissileClassX{translation "192:192=229:229", "198:198=232:232"}

actor MagMissileClass
{
var int user_P;
var int user_PP;
Translation "192:192=4:4","198:198=41:41","250:250=4:4","249:249=205:205"
PROJECTILE
damagetype "MagnetMissile"
Obituary "$OB_MAGNETMISSILE"
+DONTSEEKINVISIBLE//
+SEEKERMISSILE
+LOOKALLAROUND
reactiontime 20
damage (15+(user_PP*0.5))
Radius 8
Height 8
speed 33
scale 3.0//2.5
States
{
Spawn:
TNT1 A 0
TNT1 A 0 ACS_NamedExecuteAlways("BULL_Tidifier", 0)
SpawnLOOP:
MAGB T 0 A_JumpIf(ACS_ExecuteWithResult(C_CHECK_TARGET_OOC)==0,"SpawnHomed")
MAGB TTT 1 A_JumpIfInTargetInventory("MagnetmanFlag1",1,"Home")
MAGB T 0 A_SetUserVar("user_P",user_P+1)
MAGB T 0 A_JumpIf(user_P>=16,"Spawn16")
MAGB T 0 A_SpawnItemEx("MagMissileClassFX",random(-8,8),0,Random(-8,8),random(-2,2),0,random(-2,2),random(0,359),9)
loop
Spawn16:
MAGB T 0 A_JumpIf(ACS_ExecuteWithResult(C_CHECK_TARGET_OOC)==0,"SpawnHomed")
MAGB TTT 1 A_JumpIfInTargetInventory("MagnetmanFlag1",1,"Home")
MAGB T 0 A_SetUserVar("user_P",user_P+1)
MAGB T 0 A_JumpIf(user_P>=32,"Spawn32")
MAGB TT 0 A_SpawnItemEx("MagMissileClassFX",random(-8,8),0,Random(-8,8),random(-2,2),0,random(-2,2),random(0,359),9)
loop
Spawn32:
MAGB T 0 A_JumpIf(ACS_ExecuteWithResult(C_CHECK_TARGET_OOC)==0,"SpawnHomed")
MAGB TTT 1 A_JumpIfInTargetInventory("MagnetmanFlag1",1,"Home")
MAGB T 0 A_SetUserVar("user_P",user_P+1)
MAGB TTT 0 A_SpawnItemEx("MagMissileClassFX",random(-8,8),0,Random(-8,8),random(-2,2),0,random(-2,2),random(0,359),9)
loop

SpawnHomed:
MAGB U 2
loop

HomeFlag:
MAGB T 0 A_ChangeFlag("SCREENSEEKER",0)
goto Home+1
Home:
MAGB T 0 A_JumpIf(user_P>=12,"HomeFlag")
MAGB T 0 //A_LogInt(user_P)
MAGB T 0 A_ScaleVelocity(0.01)
MAGB T 0 A_GiveInventory("MagnetmanFlag2",1)
MAGB T 0 A_RearrangePointers(AAPTR_DEFAULT,AAPTR_DEFAULT,AAPTR_NULL)
MAGB T 0 A_PlaySoundEx("S3_K/Beep","Weapon")
MAGB T 1 A_SetUserVar("user_PP",user_P)
MAGB T 1 A_SeekerMissile(90, 90, SMF_LOOK|SMF_PRECISE|SMF_CURSPEED, 256, 5)
MAGB T 1 A_SeekerMissile(50+(user_P*0.5), 50+(user_P*0.5), SMF_LOOK|SMF_PRECISE|SMF_CURSPEED, 256, 5)
MAGB T 7
MAGB U 1 A_ScaleVelocity(150)
MAGB T 0 A_FaceTracer
MAGB U 0 A_JumpIfInventory("IsInGame",1,"HomeCheck",AAPTR_TRACER)
goto SpawnHomed
HomeCheck:
//MAGB U 0 A_JumpIf(user_P>=32,"HomeSuper")
//MAGB U 0 A_JumpIfInventory("HeHasMyPowerPower",1,"Home3",AAPTR_TRACER)
MAGB U 1 
//A_SeekerMissile(user_P*2,user_P+3,6,50,3)
goto Home2
Home2:
//MAGB U 0 A_JumpIf(momz != 0,"Pitched")
MAGB UUUU 1 
//A_SeekerMissile(user_P*0.5,user_P+1,6,50,3)
//MAGB U 0 A_JumpIf(momz != 0,"Pitched")
MAGB U 0 A_SetUserVar("user_P",user_P-1)
MAGB UUUU 1 
//A_SeekerMissile(user_P*0.5,user_P+1,6,50,3)
//MAGB U 0 A_JumpIf(momz != 0,"Pitched")
MAGB U 0 A_SetUserVar("user_P",user_P-1)
MAGB UUUU 1 
//A_SeekerMissile(user_P*0.5,user_P+1,6,50,3)
//MAGB U 0 A_JumpIf(momz != 0,"Pitched")
MAGB U 0 A_SetUserVar("user_P",user_P-1)
MAGB UUUU 1 
//A_SeekerMissile(user_P*0.5,user_P+1,6,50,3)
//MAGB U 0 A_JumpIf(momz != 0,"Pitched")
MAGB U 0 A_SetUserVar("user_P",user_P-1)
MAGB UUUU 1 
//A_SeekerMissile(user_P*0.5,user_P+1,6,50,3)
MAGB U 0 A_SetUserVar("user_P",user_P-1)
//MAGB U 0 A_ScaleVelocity(0.8)
//MAGB U 0 A_JumpIf(user_P>0,"Home2")
goto HomeCheck
Pitched:
MAGB U 0 A_ScaleVelocity(0.8)
MAGB UUUU 1 A_SeekerMissile(user_P*0.5,user_P+1,6,50,3)
MAGB U 0 A_SetUserVar("user_P",user_P-1)
MAGB UUUU 1 A_SeekerMissile(user_P*0.5,user_P+1,6,50,3)
MAGB U 0 A_SetUserVar("user_P",user_P-1)
MAGB UUUU 1 A_SeekerMissile(user_P*0.5,user_P+1,6,50,3)
MAGB U 0 A_SetUserVar("user_P",user_P-1)
MAGB UUUU 1 A_SeekerMissile(user_P*0.5,user_P+1,6,50,3)
MAGB U 0 A_SetUserVar("user_P",user_P-1)
MAGB UUUU 1 A_SeekerMissile(user_P*0.5,user_P+1,6,50,3)
MAGB U 0 A_SetUserVar("user_P",user_P-1)
MAGB U 0 A_JumpIf(user_P>0,"Home2")
goto HomeCheck
Home3:
MAGB UUUUUUUUUUUUUUUUUUUU 1 A_SeekerMissile(user_P+1,user_P*2+2,6,50,3)
MAGB U 0 A_ScaleVelocity(4.0/3.0)
goto SpawnHomed
HomeSuper://Peace out
MAGB UUU 1 A_SeekerMissile(90,90,3,50,3)
MAGB U 0 A_CountDown
loop
Death:
TNT1 A 0 //A_LogInt(user_P)
TNT1 A 0 A_JumpIfInventory("MagnetmanFlag2",1,"Death2")
TNT1 A 0 A_GiveToTarget("MagnetmanFlag2",1)
TMFX ABCD 2
stop
Death2:
WMFX ABCD 2
stop
}
}


actor MagMissileClassB : MagMissileClass{Translation "192:192=205:205","198:198=74:74","250:250=196:196","249:249=199:199","195:195=74:74"}
actor MagMissileClassR : MagMissileClass{Translation "192:192=171:171","198:198=41:41","250:250=170:170","249:249=43:43","195:195=41:41"}
actor MagMissileClassO : MagMissileClass{Translation "192:192=104:104","198:198=128:128","250:250=138:138","249:249=131:131","195:195=128:128"}
actor MagMissileClassP : MagMissileClass{Translation "192:192=229:229","198:198=232:232","250:250=214:214","249:249=223:223","195:195=232:232"}

//actor HeHasMyPowerPower : Powerup{Powerup.Duration 90}

actor MagflyMagnetX : BasicHelper
{
height 64
scale 2.5
+FLOATBOB
renderstyle normal
reactiontime 210
Translation "192:192=4:4","198:198=41:41"
States
{
Spawn:
MAG3 A 0 A_Stop
MAG3 A 0 ACS_NamedExecuteAlways("Trill_MagnetJumpBooster",0,128)
MAG3 AA 0 A_SpawnItemEx("MagParticleSpawnerX",0,0,-(z-floorz),0,0,0,0,SXF_TRANSFERTRANSLATION)
MAG3 A 1 A_Countdown
MAG3 A 0 A_JumpIfInTargetInventory("WeaponCharge",1,"BRRRRRRRRRR")
MAG3 A 0 ACS_NamedExecuteAlways("Trill_MagnetJumpBooster",0,128)
MAG3 AA 0 A_SpawnItemEx("MagParticleSpawnerX",0,0,-(z-floorz),0,0,0,0,SXF_TRANSFERTRANSLATION)
MAG3 A 1 A_Countdown
MAG3 A 0 A_JumpIfInTargetInventory("WeaponCharge",1,"BRRRRRRRRRR")
MAG3 A 0 ACS_NamedExecuteAlways("Trill_MagnetJumpBooster",0,128)
MAG3 AA 0 A_SpawnItemEx("MagParticleSpawnerX",0,0,-(z-floorz),0,0,0,0,SXF_TRANSFERTRANSLATION)
MAG3 A 1 A_Countdown
MAG3 A 0 A_JumpIfInTargetInventory("WeaponCharge",1,"BRRRRRRRRRR")
MAG3 A 0 ACS_NamedExecuteAlways("Trill_MagnetJumpBooster",0,128)
MAG3 AA 0 A_SpawnItemEx("MagParticleSpawnerX",0,0,-(z-floorz),0,0,0,0,SXF_TRANSFERTRANSLATION)
MAG3 B 1 A_Countdown
MAG3 A 0 A_JumpIfInTargetInventory("WeaponCharge",1,"BRRRRRRRRRR")
MAG3 A 0 ACS_NamedExecuteAlways("Trill_MagnetJumpBooster",0,128)
MAG3 AA 0 A_SpawnItemEx("MagParticleSpawnerX",0,0,-(z-floorz),0,0,0,0,SXF_TRANSFERTRANSLATION)
MAG3 B 1 A_Countdown
MAG3 A 0 A_JumpIfInTargetInventory("WeaponCharge",1,"BRRRRRRRRRR")
MAG3 A 0 ACS_NamedExecuteAlways("Trill_MagnetJumpBooster",0,128)
MAG3 AA 0 A_SpawnItemEx("MagParticleSpawnerX",0,0,-(z-floorz),0,0,0,0,SXF_TRANSFERTRANSLATION)
MAG3 B 1 A_Countdown
MAG3 A 0 A_JumpIfInTargetInventory("WeaponCharge",1,"BRRRRRRRRRR")
loop
Death:
MAGB A 0 A_TakeFromTarget("CutterFlag",999)
NAPA E 0 A_PlaySoundEx("misc/mm3explosion", "Body")
MAGB A 0 A_GiveToTarget("MagFlyDelay",70)
MAGB A 0 A_TakeFromTarget("MagFlyIsOut",999)
NAPA EFGHIJKLMNOPQRS 1
stop
BRRRRRRRRRR:
NAPA E 0 A_PlaySoundEx("S3_K/Beep", "Body")
MAG3 A 0 A_SpawnItemEX("MagflyMagnetMad",0,0,0,0,0,0,0,1)
stop
}
}

actor MagflyMagnetMad
{
PROJECTILE
Translation "192:192=4:4","198:198=41:41"
speed 0
+THRUACTORS
damage (0)
scale 2.5
reactiontime 70
states
{
Spawn:
MAG3 A 2 A_PlaySoundEx("Weapon/Thunderbolt","Weapon")
MAG3 B 0 A_Quake(5,2,0,128)
MAG3 B 0 A_Quake(1,2,0,512)
MAG3 B 0 A_CountDown
MAG3 AAAA 0 A_SpawnItemEx("MagMissileClassFX2", random(0, 128), 0, Random(0, 8), 0, 0, random(-40, -50), random(0,359), SXF_ABSOLUTEMOMENTUM|SXF_TRANSFERTRANSLATION)
MAG3 AAAA 0 A_SpawnItemEx("MagMissileClassFX3", random(0, 128), 0, Random(0, 8), 0, 0, random(-40, -50), random(0,359), SXF_ABSOLUTEMOMENTUM|SXF_TRANSFERTRANSLATION)
MAG3 AAAA 0 A_SpawnItemEx("MagParticleSpawnerX2",0,0,-(z-floorz),0,0,0,0,SXF_TRANSFERTRANSLATION)
//MAG3 A 0 A_SpawnItemEx("MagFlyExploder",0,0,-(z-floorz),0,0,0,0,SXF_TRANSFERTRANSLATION)
MAG3 B 2 //A_PlaySoundEx("Weapon/Thunderbolt","Weapon")
MAG3 B 0 A_Quake(5,2,0,128)
MAG3 B 0 A_Quake(1,2,0,512)
MAG3 B 0 A_CountDown
MAG3 AAAA 0 A_SpawnItemEx("MagMissileClassFX2", random(0, 128), 0, Random(0, 8), 0, 0, random(-40, -50), random(0,359), SXF_ABSOLUTEMOMENTUM|SXF_TRANSFERTRANSLATION)
MAG3 AAAA 0 A_SpawnItemEx("MagMissileClassFX3", random(0, 128), 0, Random(0, 8), 0, 0, random(-40, -50), random(0,359), SXF_ABSOLUTEMOMENTUM|SXF_TRANSFERTRANSLATION)
MAG3 AAAA 0 A_SpawnItemEx("MagParticleSpawnerX2",0,0,-(z-floorz),0,0,0,0,SXF_TRANSFERTRANSLATION)
MAG3 A 0 A_SpawnItemEx("MagFlyExploder",0,0,-(z-floorz),0,0,0,0,SXF_TRANSFERTRANSLATION)
loop
Death:
MAG3 A 0 A_SpawnItemEx("MagFlyExploderFinal",0,0,-(z-floorz),0,0,0,0,SXF_TRANSFERTRANSLATION)//HAHA 69 DAMAGE LMAOOOOOOOOOOOOOOOOOOOOOO
MAGB A 0 A_TakeFromTarget("CutterFlag",999)
MAGB A 0 A_TakeFromTarget("WeaponCharge",999)
NAPA E 0 A_PlaySoundEx("misc/mm3explosion", "Body")
MAG3 A 0 A_TakeFromTarget("MagFlyIsOut",999)
MAGB A 0 A_GiveToTarget("MagFlyDelay",105)
NAPA EFGHIJKLMNOPQRS 1
stop
}
}

actor MagFlyExploder : BasicExplosion
{
damagetype "MadMagFly"
Obituary "$OB_MAGNETMANFLY"
States
{
Spawn:
TNT1 A 0
TNT1 AA 2 A_Explode(1,128,0,0,128)
stop
}
}

actor MagFlyExploderFinal : MagFlyExploder
{
States
{
Spawn:
TNT1 A 0
TNT1 A 2 A_Explode(1,128,0,0,128)
stop
}
}

actor MagnetJumpBoost : PowerHighJump
{
powerup.duration 17
}

actor MagParticleSpawnerX
{
+NOINTERACTION
+NOGRAVITY
+CLIENTSIDEONLY
+FORCEXYBILLBOARD
-SOLID
+FLOORHUGGER
scale 2.5
height 0
radius 0
States
{
Spawn:
TNT1 A 0
TNT1 AA 0 A_SpawnItemEx("MagMissileClassFX", random(0, 128), 0, Random(0, 8), momx, momy, random(4, 10), random(0,359), SXF_ABSOLUTEMOMENTUM|SXF_TRANSFERTRANSLATION)
stop
}
}

actor MagParticleSpawnerX2
{
+NOINTERACTION
+NOGRAVITY
+CLIENTSIDEONLY
+FORCEXYBILLBOARD
-SOLID
+FLOORHUGGER
scale 2.5
height 0
radius 0
States
{
Spawn:
TNT1 A 0
TNT1 AA 0 A_SpawnItemEx("MagMissileClassFX", random(0, 128), 0, Random(0, 8), momx, momy, 0, random(0,359), SXF_ABSOLUTEMOMENTUM|SXF_TRANSFERTRANSLATION)
stop
}
}


actor MagneticMine
{
Translation "192:192=4:4","198:198=41:41"
species "MagnetMissile"
+MISSILE
+THRUSPECIES
+NOGRAVITY
Obituary "$OB_MAGNETMAN4"
+FLOATBOB
+SHOOTABLE
+CANTSEEK
+NOTARGETSWITCH
+SEEKERMISSILE
+LOOKALLAROUND
+QUICKTORETALIATE
+FLOATBOB
+AMBUSH
+DONTREFLECT
+NOPAIN
health 30
painchance 256
mass 999999
FloatBobPhase 31
Radius 16
Height 16
scale 2.5
speed 10
damage (0)
reactiontime 175
Damagetype "MagnetMissile"
DamageFactor "MadMagFly", 0.0
DamageFactor "MagnetMissile", 0.0
States
{
Spawn:
TNT1 A 0
MAPJ IJK 2 A_ScaleVelocity(1.5)
Goto Start
Start:
TNT1 A 0 A_Stop
MAPJ L 0 A_JumpIfTargetInLOS("See", 0, 1)
MAPJ L 1 A_SeekerMissile (60, 45, SMF_LOOK, 256, 4)
MAPJ L 0 A_Countdown
loop
See:
MAPJ A 0 A_PlaySoundEx("weapon/magnetminefly","Body",1)
loopit:
MAPJ MMLLLLL 1 A_SeekerMissile (75, 45, SMF_LOOK, 50, 10)
MAPJ LLLLLLL 0 A_Countdown
loop
Death:
NAPA E 0 A_ChangeFlag("FLOATBOB",0)
NAPA E 0 A_Stop
NAPA E 0 A_PlaySoundEx("misc/mm3explosion", "Body")
NAPA E 0 A_Explode(10, 96, 0, 0, 48)
NAPA EFGHIJKLMNOPQRS 1
stop
}
}

actor MagneticMineB : MagneticMine{Translation "192:192=205:205","198:198=74:74"}
actor MagneticMineR : MagneticMine{Translation "192:192=171:171","198:198=41:41"}
actor MagneticMineO : MagneticMine{Translation "192:192=104:104","198:198=128:128"}
actor MagneticMineP : MagneticMine{Translation "192:192=229:229","198:198=232:232"}

actor PullChargeFX_Helper : BasicHelper
{
States
{
Spawn:
TNT1 A 0
TNT1 A 0 A_SpawnItemEx("MagMissileClassFX",random(2,12),0,random(48,56),0,0,frandom(1,2),random(1,16)*20,1)
TNT1 A 1
stop
}
}

actor MagMissileClassFX : BasicClientSide
{
States
{
Spawn:
TNT1 A 0
TNT1 A 0 A_Jump(256,1,3)
X_0C E 5
X_0C E 1 A_Fadeout(0.1)
wait
X_0C F 5
X_0C F 1 A_Fadeout(0.1)
wait
}
}

actor MagMissileClassFX2 : BasicClientSide
{
alpha 0.1
States
{
Spawn:
TNT1 A 0
X_0C EEEEEEEEEE 1 A_FadeIn(0.2)
SpawnLOOP:
X_OC F 10
loop
}
}

actor MagMissileClassFX3 : BasicClientSide
{
alpha 0.1
States
{
Spawn:
TNT1 A 0
X_0C FFFFFFFFFF 1 A_FadeIn(0.2)
SpawnLOOP:
X_OC F 10
loop
}
}

actor MagPush1 : BasicExplosion
{
var int user_P;
damagetype "MagPush"
Obituary "$OB_MAGNETPUSH"
states
{
Spawn:
TNT1 A 0
TNT1 A 0 A_SetUserVar("user_P",ACS_ExecuteWithResult(C_CHECK_TARGET_ITEM,2))
TNT1 A 4 A_Explode(1,128+(user_P*2.25),0,0,128+(user_P*2.25))
TNT1 A 2 A_TakeFromTarget("PullCharge",999)
stop
}
}

actor MagPushFX
{
-SOLID
+NOGRAVITY
+DONTSPLASH
+NONETID
Radius 2
Height 2
scale 2.5
States
{
Spawn:
MAGB JIJ 2
stop
}
}

actor MagflyMagnetSpawnerBloke : ThunderWool
{
Translation "192:192=4:4","198:198=41:41"
+THRUACTORS
-BOUNCEONCEILINGS
-FORCEXYBILLBOARD
Height 64
States
{
Spawn:
MAG3 A 0
MAG3 A 0 A_GiveToTarget("MagFlyIsOut",999)
MAG3 AAAA 3 ThrustThingZ(0,9,0,1)
MAG3 E 0 ThrustThingZ(0,9,0,1)
MAG3 AAAAAAAAA 1
Death:
MAG3 A 0 A_SpawnItemEX("MagflyMagnetX",0,0,0,0,0,0,0,SXF_TRANSFERTRANSLATION)
stop
}
}

actor MagflyMagnetSpawnerBlokeB : MagflyMagnetSpawnerBloke{Translation "192:192=205:205","198:198=74:74","250:250=196:196","249:249=199:199","195:195=74:74"}
actor MagflyMagnetSpawnerBlokeR : MagflyMagnetSpawnerBloke{Translation "192:192=171:171","198:198=41:41","250:250=170:170","249:249=43:43","195:195=41:41"}
actor MagflyMagnetSpawnerBlokeO : MagflyMagnetSpawnerBloke{Translation "192:192=104:104","198:198=128:128","250:250=138:138","249:249=131:131","195:195=128:128"}
actor MagflyMagnetSpawnerBlokeP : MagflyMagnetSpawnerBloke{Translation "192:192=229:229","198:198=232:232","250:250=214:214","249:249=223:223","195:195=232:232"}

actor MagnetmanMain_CI : TeamColor_CI
{
states
{
FireX:
TNT1 A 0 A_FireCustomMissile("MagMissileClass",0,1,8,0)
goto Done
FireB:
TNT1 A 0 A_FireCustomMissile("MagMissileClassB",0,1,8,0)
goto Done
FireR:
TNT1 A 0 A_FireCustomMissile("MagMissileClassR",0,1,8,0)
goto Done
FireO:
TNT1 A 0 A_FireCustomMissile("MagMissileClassO",0,1,8,0)
goto Done
FireP:
TNT1 A 0 A_FireCustomMissile("MagMissileClassP",0,1,8,0)
goto Done
}
}


actor MagnetmanMainX_CI : TeamColor_CI
{
states
{
FireX:
TNT1 A 0 A_FireCustomMissile("MagMissileClassX",0,1,8,0)
goto Done
FireB:
TNT1 A 0 A_FireCustomMissile("MagMissileClassXB",0,1,8,0)
goto Done
FireR:
TNT1 A 0 A_FireCustomMissile("MagMissileClassXR",0,1,8,0)
goto Done
FireO:
TNT1 A 0 A_FireCustomMissile("MagMissileClassXO",0,1,8,0)
goto Done
FireP:
TNT1 A 0 A_FireCustomMissile("MagMissileClassXP",0,1,8,0)
goto Done
}
}

actor MagnetmanAlt_CI : TeamColor_CI
{
states
{
FireX:
TNT1 A 0 A_FireCustomMissile("MagflyMagnetSpawnerBloke",0,1,8,0)
goto Done
FireB:
TNT1 A 0 A_FireCustomMissile("MagflyMagnetSpawnerBlokeB",0,1,8,0)
goto Done
FireR:
TNT1 A 0 A_FireCustomMissile("MagflyMagnetSpawnerBlokeR",0,1,8,0)
goto Done
FireO:
TNT1 A 0 A_FireCustomMissile("MagflyMagnetSpawnerBlokeO",0,1,8,0)
goto Done
FireP:
TNT1 A 0 A_FireCustomMissile("MagflyMagnetSpawnerBlokeP",0,1,8,0)
goto Done
}
}

actor MagnetReload_CI : TeamColor_CI
{
states
{
FireX:
//TNT1 A 0 A_FireCustomMissile("MagneticMine",60,0,0,0)
TNT1 A 0 A_FireCustomMissile("MagneticMine",0,0,0,0)
//TNT1 A 0 A_FireCustomMissile("MagneticMine",-60,0,0,0)
goto Done
FireB:
//TNT1 A 0 A_FireCustomMissile("MagneticMineB",60,0,0,0)
TNT1 A 0 A_FireCustomMissile("MagneticMineB",0,0,0,0)
//TNT1 A 0 A_FireCustomMissile("MagneticMineB",-60,0,0,0)
goto Done
FireR:
//TNT1 A 0 A_FireCustomMissile("MagneticMineR",60,0,0,0)
TNT1 A 0 A_FireCustomMissile("MagneticMineR",0,0,0,0)
//TNT1 A 0 A_FireCustomMissile("MagneticMineR",-60,0,0,0)
goto Done
FireO:
//TNT1 A 0 A_FireCustomMissile("MagneticMineO",60,0,0,0)
TNT1 A 0 A_FireCustomMissile("MagneticMineO",0,0,0,0)
//TNT1 A 0 A_FireCustomMissile("MagneticMineO",-60,0,0,0)
goto Done
FireP:
//TNT1 A 0 A_FireCustomMissile("MagneticMineP",60,0,0,0)
TNT1 A 0 A_FireCustomMissile("MagneticMineP",0,0,0,0)
//TNT1 A 0 A_FireCustomMissile("MagneticMineP",-60,0,0,0)
goto Done
}
}